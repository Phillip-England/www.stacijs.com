class Watcher{static observerStCloak(e){let t=e=>{let t=e.getAttribute("st-cloak");t=="true"&&(e.style.visibility="hidden"),t=="false"&&(e.style.visibility="visible")};t(e);const n=new MutationObserver(()=>{t(e)});n.observe(e,{attributes:!0,attributeFilter:["st-cloak"]})}static observerStHide(e){const t=e=>{let t=e.getAttribute("st-hide");if(t==="true")e.hasAttribute("st-hide-prev")||e.setAttribute("st-hide-prev",e.style.display||""),e.style.display="none";else if(t==="false"){let t=e.getAttribute("st-hide-prev");e.style.display=t||"flex"}};t(e);const n=new MutationObserver(()=>{t(e)});n.observe(e,{attributes:!0,attributeFilter:["st-hide"]})}}class Everest{static throttle(e,t){let n=0;return function(...o){const s=Date.now();s-n>=t&&(n=s,e.apply(this,o))}}static debounce(e,t){let n;return function(...s){clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}}class Dom{static getDirectTextContent(e){let t="";return e.childNodes.forEach(e=>{e.nodeType===Node.TEXT_NODE&&(t+=e.nodeValue)}),t.trim()}static replaceTextContent(e,t,n){const s=e.textContent,o=s.replace(t,n);e.textContent=o}static ClimbDomUntil(e,t){if(!e||typeof t!="function")throw new Error("Invalid arguments: Provide a valid element and a callback function.");let n=e;for(;n;){if(t(n))return!0;if(n===document.body)break;n=n.parentElement}return!1}}class Iter{static map(e,t){for(let n=0;n<e.length;n++){let s=t(e[n]);if((s==null)&&console.error("forgot to return true from Iter.map(items, fn), return false to break"),!s)break}}static mapObj(e,t){for(let[s,o]of Object.entries(e)){let n=t(s,o);if((n==null)&&console.error("forgot to return true from Iter.mapObj(items, fn), return false to break"),!n)break}}}class Purse{static scanBetweenSubStrs(e,t,n){const a=[];let i=!1,o="",s=0;for(;s<e.length;){if(!i&&s+t.length<=e.length&&e.substring(s,s+t.length)===t&&(s===0||e[s-1]!=="\\")){i=!0,o=t,s+=t.length;continue}if(i){if(s+n.length<=e.length&&e.substring(s,s+n.length)===n){o+=n,a.push(o),o="",i=!1,s+=n.length;continue}o+=e[s]}s++}return a}static removeFromArray(e,...t){return e.filter(e=>!t.includes(e))}static strIsInt(e){if(typeof e!="string")return!1;const t=Number(e);return Number.isInteger(t)&&e.trim()!==""}static ifElse(e,t,n){return e==t?n:e==n?t:(console.error("used Purse.ifElse, but function returned a null value"),null)}}class Signal{constructor(e){this.value=e,this.listeners=new Set,this.history=[e]}val(){return this.value}set(e){let t=this.val();this.value!==e&&(this.value=e,this.notify(t))}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notify(e){this.listeners.forEach(t=>t(e,this.value))}}class CustomScroll extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML=`
            <style>
                .custom-scroll::-webkit-scrollbar {
                    width: 8px;
                    height: 8px;
                }
                .custom-scroll::-webkit-scrollbar-thumb {
                    background-color: #4B5563; /* Gray-600 */
                    border-radius: 4px;
                }
                .custom-scroll::-webkit-scrollbar-track {
                    background-color: #1F2937; /* Gray-800 */
                }
            </style>
        `}}class TitleLinks extends HTMLElement{constructor(){super()}connectedCallback(){const e=this.getAttribute("target"),n=parseInt(this.getAttribute("offset"),10)||0,t=document.querySelector(e);if(!t){console.error(`Target element "${e}" not found.`);return}const s=t.querySelectorAll("h1, h2, h3, h4, h5, h6");s.forEach(e=>{if(e.id){const n=document.createElement("div"),t=document.createElement("a");t.classList.add("title-link"),t.href=`#${e.id}`,t.textContent=e.textContent,n.appendChild(t),this.appendChild(n)}});const o=document.createElement("style");this.appendChild(o),this.addEventListener("click",e=>{if(e.target.tagName==="A"){e.preventDefault();const s=e.target.getAttribute("href").substring(1),t=document.getElementById(s);if(t){const e=t.getBoundingClientRect().top+window.pageYOffset+n;window.scrollTo({top:e,behavior:"smooth"})}}})}}class StSignal extends HTMLElement{constructor(){super()}connectedCallback(){this.setAttribute("style","visibility:hidden;")}}customElements.define("custom-scroll",CustomScroll),customElements.define("st-signal",StSignal),customElements.define("title-links",TitleLinks);class Staci{constructor(){this.version="0.0.1",this.repo="https://github.com/phillip-england/staci",this.events={},this.signals={},this.eventPairs=[["st-click","click"],["st-dblclick","dblclick"],["st-mouseup","mouseup"],["st-mousedown","mousedown"],["st-mousemove","mousemove"],["st-mouseenter","mouseenter"],["st-mouseleave","mouseleave"],["st-keydown","keydown"],["st-keypress","keypress"],["st-keyup","keyup"],["st-focus","focus"],["st-blur","blur"],["st-submit","submit"],["st-change","change"],["st-input","input"],["st-focusin","focusin"],["st-focusout","focusout"],["st-select","select"],["st-resize","resize"],["st-scroll","scroll"],["st-wheel","wheel"],["st-touchstart","touchstart"],["st-touchend","touchend"],["st-touchmove","touchmove"],["st-touchcancel","touchcancel"],["st-pointerdown","pointerdown"],["st-pointerup","pointerup"],["st-pointermove","pointermove"],["st-pointerenter","pointerenter"],["st-pointerleave","pointerleave"],["st-pointercancel","pointercancel"],["st-contextmenu","contextmenu"],["st-wheel","wheel"],["st-drag","drag"],["st-dragstart","dragstart"],["st-dragend","dragend"],["st-dragover","dragover"],["st-dragenter","dragenter"],["st-dragleave","dragleave"],["st-drop","drop"],["st-input","input"],["st-keydown","keydown"],["st-keyup","keyup"]],this.initOnLoad()}initOnLoad(){document.addEventListener("DOMContentLoaded",()=>{this.initAllEventTypes(),this.initSignalTextPlaceholders(),this.initSignalAttrPlaceholders(),this.initAttrObservers()})}initAllEventTypes(){Iter.map(this.eventPairs,e=>{let t=e[0],n=e[1];return this.initEventsOfType(t,n),!0})}initEventsOfType(e,t){Iter.mapObj(this.events,()=>{let o=document.querySelectorAll(`*[${e}]`);return Iter.map(o,n=>{let s=n.getAttribute(`${e}`),o=s.split(";");return Iter.map(o,s=>{let o=staci.getEvent(s),i=n.getAttribute("st-throttle");if(i){let r=Purse.strIsInt(i);r||console.error(`element ${element} contains st-throttle with a string that cannot be converted to an int ${i}`);let a=parseInt(i),s=n.getAttribute("st-events");return s?s.includes(e)||(n.addEventListener(t,Everest.throttle(o,a)),n.setAttribute("st-events",s+";"+e)):(n.addEventListener(t,Everest.throttle(o,a)),n.setAttribute("st-events",e)),!0}let a=n.getAttribute("st-debounce");if(a){let r=Purse.strIsInt(a);r||console.error(`element ${element} contains st-debounce with a string that cannot be converted to an int ${a}`);let i=parseInt(a),s=n.getAttribute("st-events");return s?s.includes(e)||(n.addEventListener(t,Everest.debounce(o,i)),n.setAttribute("st-events",s+";"+e)):(n.addEventListener(t,Everest.debounce(o,i)),n.setAttribute("st-events",e)),!0}let r=n.getAttribute("st-events");return r?r.includes(e)||(n.addEventListener(t,o),n.setAttribute("st-events",r+";"+e)):(n.addEventListener(t,o),n.setAttribute("st-events",e)),!0}),!0}),!0})}initSignalTextPlaceholders(){let e=document.querySelectorAll("*"),t=[];Iter.map(e,e=>{let n=e.getAttribute("st-ignore");return n==null||(n=="true"&&t.push(e),!0)}),Iter.map(e,e=>{let s=Dom.ClimbDomUntil(e,e=>{let t=e.getAttribute("st-ignore");if(t==null)return!1;if(t=="true")return!0}),t=e.getAttribute("st-force"),n=!1;if(t&&t=="true"&&(n=!0),!n&&s)return!0;let o=Dom.getDirectTextContent(e),i=Purse.scanBetweenSubStrs(o,"{|","|}");return Iter.map(i,t=>{let s=t.replace("{|","").replace("|}","").trim(),n=staci.getSignalFull(s);(n==null)&&console.error(`attempting to set signal values on a {{ }} placeholder, but
                    we encountered a null signal from using the key ${s} and placeholder ${t}`),Dom.replaceTextContent(e,t,n.val());let o=e.getAttribute("style");return o==null||(o.includes("hidden")&&e.setAttribute("style",""),n.subscribe((t,n)=>{Dom.replaceTextContent(e,t,n)}),!0)}),!0})}initSignalAttrPlaceholders(){let e=document.querySelectorAll("*");Iter.map(e,e=>(Iter.map(e.attributes,t=>{let s=t.name,n=t.value,o=Purse.scanBetweenSubStrs(n,"{|","|}");return Iter.map(o,t=>{let o=t.replace("{|","").replace("|}","").trim(),r=!1;o[0]=="!"&&(o=o.replace("!",""),r=!0);let i=staci.getSignalFull(o);(i==null)&&console.error(`attempting to set signal values on a {{ }} placeholder, but
                        we encountered a null signal from using the key ${o} and placeholder ${t}`);let a=null;return r?(n=n.replace(t,!i.val()),a=(t,o)=>{if(typeof t=="string"&&typeof o=="string"){let t=n.split(" ");t=t.filter(e=>e!=o),t.push(...o.split(" ")),e.setAttribute(s,t.join(" "));return}n=n.replace(!t,!o),e.setAttribute(s,n)}):(n=n.replace(t,i.val()),a=(t,o)=>{if(typeof t=="string"&&typeof o=="string"){let i=n.split(" ");i=i.filter(e=>e!=t),i.push(...o.split(" ")),e.setAttribute(s,i.join(" "));return}n=n.replace(t,o),e.setAttribute(s,n)}),e.setAttribute(s,n),i.subscribe(a),!0}),!0}),!0))}initAttrObservers(){let e=document.querySelectorAll("*");Iter.map(e,e=>(Watcher.observerStHide(e),Watcher.observerStCloak(e),!0))}event(e,t){this.events[e]=t}set(e,t){this.signals[e]=new Signal(t)}getEvent(e){let t=!1,n=null;return Iter.mapObj(this.events,(s,o)=>e!=s||(t=!0,n=o,!1)),t==!1?(console.error(`attempted to access event named ${e} when one does not exist`),null):n}get(e){let n=!1,t=null;return Iter.mapObj(this.signals,(s,o)=>e!=s||(n=!0,t=o,!1)),n==!1?(console.error(`attempted to access signal named ${e} when one does not exist`),null):[t.val(),e=>{t.set(e)}]}getSignalFull(e){let t=!1,n=null;return Iter.mapObj(this.signals,(s,o)=>e!=s||(t=!0,n=o,!1)),t==!1?(console.error(`attempted to access signal named ${e} when one does not exist`),null):n}}let staci=new Staci;console.log(staci)